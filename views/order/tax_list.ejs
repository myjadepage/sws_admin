<%- include('../inc/head') %>

    <div id="container">

        <%- include('../inc/sidebar') %>

            <div id="contents">
                <h3>세금계산서신청관리</h3>
                <ul class="navi">
                    <li class="home"><a href="/" target="_top">홈</a></li>
                    <li>주문/매출관리</li>
                    <li>거래증빙서류관리</li>
                    <li class="on">세금계산서신청관리</li>
                </ul>
                <ul class="helpbox">
                    <li>세금계산서 신청 내역을 관리합니다.</li>
                </ul>


                <form name="sFrm">

                    <table class="t_form">
                        <caption>세금계산서 검색</caption>
                        <colgroup>
                            <col width="130">
                            <col width="*">
                        </colgroup>
                        <tbody>
                            <tr>
                                <th>발급상태</th>
                                <td>
                                    <select id="sissue" name="sissue" onchange="change();"><option value="">선택</option><option value="100">발급신청</option><option value="200">발급처리중</option><option value="900">발급완료</option></select>

                                </td>
                            </tr>
                            <tr>
                                <th>기간</th>
                                <td>
                                    <div>
                                        <input type="text" id="sdts" name="sdts" value="" maxlength="10" class="text_input" style="width:70px">
                                        <img src="/img/btn_open.gif" onclick="calendar.open(event, 'sdts', 'YYYY-MM-DD')" style="vertical-align:middle"> ~
                                        <input type="text" id="sdte" name="sdte" value="" maxlength="10" class="text_input" style="width:70px">
                                        <img src="/img/btn_open.gif" onclick="calendar.open(event, 'sdte', 'YYYY-MM-DD')" style="vertical-align:middle"> 직접 입력시에는 “2007-01-01” 형식으로 입력해주세요.
                                    </div>
                                    <div class="mgt5">
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte')">전체</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 't')">오늘</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 't', -1)">어제</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 'd', -3)">3일간</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 'd', -7)">7일간</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 'd', -10)">10일간</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 'd', -20)">20일간</button></span>
                                        <span class="button small"><button type="button" onclick="inperiod.input('sdts', 'sdte', 'd', -30)">30일간</button></span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th>직접검색</th>
                                <td>
                                    <select id="skey" name="skey"><option value="">전체</option><option value="ordno">주문번호</option><option value="ordname">주문자명</option></select>

                                    <input type="text" name="sword" value="" class="text_input" style="width:300px">
                                    <span class="button small black"><button type="submit">검색</button></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </form>

                <div class="section_head">
                    <h4>총 <span><strong>2</strong></span>건이 조회 되었습니다.</h4>
                </div>

                <form name="Frm">
                    <input type="hidden" name="idx">
                    <input type="hidden" name="params" value="sissue=&sdts=&sdte=&skey=&sword=&page=">

                    <table class="t_list">
                        <caption>세금계산서 신청 내역</caption>
                        <colgroup>
                            <col width="25">
                            <col width="6%">
                            <col width="12%">
                            <col width="*">
                            <col width="6%">
                            <col width="8%">
                            <col width="8%">
                            <col width="7%">
                            <col width="10%">
                            <col width="70">
                            <col width="70">
                            <col width="70">
                        </colgroup>
                        <thead>
                            <tr>
                                <th rowspan="2"><input type="checkbox" name="cbListAll" onclick="checkCbAll(this.form.cbList, this.checked)"></th>
                                <th rowspan="2">No</th>
                                <th rowspan="2">주문번호<br>(주문자)</th>
                                <th colspan="3">상품정보</th>
                                <th rowspan="2">공급가</th>
                                <th rowspan="2">부가세</th>
                                <th rowspan="2">합계</th>
                                <th rowspan="2">신청일자</th>
                                <th rowspan="2">발급상태</th>
                                <th rowspan="2">관리</th>
                            </tr>
                            <tr>
                                <th>상품명</th>
                                <th>수량</th>
                                <th>단가</th>
                            </tr>
                        </thead>
                        <tbody>

                            <tr bgcolor="#ffffff">
                                <td rowspan="2"><input type="checkbox" name="cbList" value="205"></td>
                                <td rowspan="2">2</td>
                                <td rowspan="2">A1724354044907<br>(몰스토어)</td>
                                <td class="left">카푸치노 스키니 </td>
                                <td>1</td>
                                <td>40,200</td>
                                <td rowspan="2">42,727</td>
                                <td rowspan="2">4,273</td>
                                <td rowspan="2">47,000</td>
                                <td rowspan="2">2017-08-31</td>
                                <td rowspan="2">발급신청</td>
                                <td rowspan="2">
                                    <div><span class="button small"><button type="button" onclick="openOrderDetail(254)">주문정보</button></span></div>

                                    <div class="mgt3"><span class="button green small"><button type="button" onclick="openDealProof(205)">세금계산서</button></span></div>
                                    <div class="mgt3"><span class="button blue small"><button type="button" onclick="sendTax(205)">메일발송</button></span></div>

                                </td>
                            </tr>

                            <tr bgcolor="#ffffff">
                                <td class="left">【EJPXQ54】여-휘트니스</td>
                                <td>2</td>
                                <td>10,000</td>
                            </tr>

                            <tr bgcolor="#fdfae8">
                                <td rowspan="2"><input type="checkbox" name="cbList" value="203"></td>
                                <td rowspan="2">1</td>
                                <td rowspan="2">A1724353582837<br>(몰스토어)</td>
                                <td class="left">버든배낭</td>
                                <td>1</td>
                                <td>57,700</td>
                                <td rowspan="2">56,364</td>
                                <td rowspan="2">5,636</td>
                                <td rowspan="2">62,000</td>
                                <td rowspan="2">2017-08-31</td>
                                <td rowspan="2">발급신청</td>
                                <td rowspan="2">
                                    <div><span class="button small"><button type="button" onclick="openOrderDetail(251)">주문정보</button></span></div>

                                    <div class="mgt3"><span class="button green small"><button type="button" onclick="openDealProof(203)">세금계산서</button></span></div>
                                    <div class="mgt3"><span class="button blue small"><button type="button" onclick="sendTax(203)">메일발송</button></span></div>

                                </td>
                            </tr>

                            <tr bgcolor="#fdfae8">
                                <td class="left">나비리본 목걸이 </td>
                                <td>1</td>
                                <td>21,000</td>
                            </tr>

                        </tbody>
                    </table>

                    <div class="paging" style="margin-top:20px">
                        <span><a href="/order/tax_list?page=1&sissue=&sdts=&sdte=&skey=&sword="><strong>1</strong></a></span>
                    </div>

                    <ul class="order_list_btn mgt10">
                        <li class="title">상태수정 :</li>
                        <li>
                            선택한 항목을
                            <select id="batchState" name="batchState"><option value="">선택</option><option value="100">발급신청</option><option value="900">발급완료</option></select> 로(으로)
                            <span class="button"><button type="button" onclick="setStateList()">수정하기</button></span>
                        </li>
                        <li class="title">엑셀다운 :</li>
                        <li>
                            <span class="button"><button type="button" onclick="downExcel()">엑셀로 받기</button></span>
                        </li>
                    </ul>

                </form>


                <div id="footer">
                    <p>Copyright ⓒ <strong>2020&nbsp;몰인몰</strong> All rights reserved.</p>
                </div>
            </div>




            <%- include('../inc/footer') %>


                <script type="text/javascript">
                    //<![CDATA[
                    function change() {
                        var f = document.sFrm;

                        validSearch(f);

                        f.submit();
                    }

                    function validSearch(f) {
                        if (!isDate(f.sdts.value)) f.sdts.value = "";
                        if (!isDate(f.sdte.value)) f.sdte.value = "";
                    }

                    function openOrderDetail(idx) { // 주문정보 상세보기
                        openPopup("order_detail.pop?idx=" + idx, "Detail", 820, 600, "scrollbars=1");
                    }

                    function openDealProof(idx) {
                        openPopup("../../common/dealproof/tax_print.pop?idx=" + idx, "DealProof", 660, 530, "scrollbars=yes");
                    }

                    function downExcel() {
                        frmProc.location.replace("tax_list.excel?sissue=&sdts=&sdte=&skey=&sword=");
                    }

                    function sendTax(idx) {
                        var f = document.Frm;

                        if (confirm("입력된 고객메일로 세금계산서를 발송 하시겠습니까?")) {
                            f.idx.value = idx;
                            f.target = "frmProc";
                            f.action = "../../common/dealproof/tax_sendmail";
                            f.submit();
                        }
                    }

                    function setStateList() {
                        var f = document.Frm;
                        var items = "";

                        var stateText = f.batchState.options[f.batchState.selectedIndex].text;
                        var stateValue = f.batchState.options[f.batchState.selectedIndex].value;

                        if (!f.cbList) return false;

                        if (stateValue == "") {
                            alert("수정할 상태를 선택해 주세요.");
                            f.batchState.focus();
                            return false;
                        }

                        $(f.cbList).each(function() {
                            if (this.checked) {
                                items += (items ? ',' : '') + this.value;
                            }
                        });

                        if (items == '') {
                            alert(stateText + "로(으로) 수정하실 항목을 선택해 주세요.");
                            return false;
                        }

                        if (confirm("선택한 항목을 " + stateText + "로(으로) 수정하시겠습니까?")) {
                            f.idx.value = items;
                            f.action = "tax.act.asp";
                            f.submit();
                        }
                    }
                    //]]>
                </script>

                </body>

                </html>