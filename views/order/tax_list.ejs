<%- include('../inc/head') %>

    <div id="container">

        <%- include('../inc/sidebar') %>

            <div id="contents">
                <h3>세금계산서신청관리</h3>
                <ul class="navi">
                    <li class="home"><a href="/" target="_top">홈</a></li>
                    <li>주문/매출관리</li>
                    <li>거래증빙서류관리</li>
                    <li class="on">세금계산서신청관리</li>
                </ul>
                <ul class="helpbox">
                    <li>세금계산서 신청 내역을 관리합니다.</li>
                </ul>


                <form name="sFrm">
                    <table class="t_form">
                        <caption>세금계산서 검색</caption>
                        <tbody>
                            <tr>
                                <th>발급상태</th>
                                <td>
                                    <select id="sissue" name="sissue" class="text_input" onchange="change();">
                                        <option value="">선택</option><option value="100">발급신청</option>
                                        <option value="200">발급처리중</option>
                                        <option value="900">발급완료</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <th>기간</th>
                                <td>
                                    <div class="tui-datepicker-input tui-datetime-input tui-has-focus">
                                        <input id="startpicker-input" type="text" aria-label="Date">
                                        <span class="tui-ico-date"></span>
                                        <div id="startpicker-container" style="margin-left: -1px;"></div>
                                    </div>
                                    <span>~</span>
                                    <div class="tui-datepicker-input tui-datetime-input tui-has-focus">
                                        <input id="endpicker-input" type="text" aria-label="Date">
                                        <span class="tui-ico-date"></span>
                                        <div id="endpicker-container" style="margin-left: -1px;"></div>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <th>직접검색</th>
                                <td>
                                    <select id="skey" name="skey" class="text_input">
                                        <option value="">전체</option>
                                        <option value="ordno">주문번호</option>
                                        <option value="ordname">주문자명</option>
                                    </select>

                                    <input type="text" name="sword" value="" class="text_input" style="width:300px">
                                    <button class="btn btn-sm btn-default" type="submit">검색</button></span>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                </form>

                <div class="section_head">
                    <h4><i class="xi-check-circle"></i> 총 <strong>2</strong>건이 조회 되었습니다.</h4>
                </div>

                <form name="Frm">
                    <table class="t_list">
                        <caption>세금계산서 신청 내역</caption>
                        <colgroup>
                            <col width="25">
                            <col width="6%">
                            <col width="12%">
                            <col width="*">
                            <col width="6%">
                            <col width="8%">
                            <col width="8%">
                            <col width="7%">
                            <col width="10%">
                            <col width="70">
                            <col width="70">
                            <col width="70">
                        </colgroup>
                        <thead>
                            <tr>
                                <th rowspan="2"><input type="checkbox" name="cbListAll" onclick="checkCbAll(this.form.cbList, this.checked)"></th>
                                <th rowspan="2">No</th>
                                <th rowspan="2">주문번호<br>(주문자)</th>
                                <th colspan="3">상품정보</th>
                                <th rowspan="2">공급가</th>
                                <th rowspan="2">부가세</th>
                                <th rowspan="2">합계</th>
                                <th rowspan="2">신청일자</th>
                                <th rowspan="2">발급상태</th>
                                <th rowspan="2">관리</th>
                            </tr>
                            <tr>
                                <th>상품명</th>
                                <th>수량</th>
                                <th>단가</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="2"><input type="checkbox" name="cbList" value="205"></td>
                                <td rowspan="2">2</td>
                                <td rowspan="2">A1724354044907<br>(몰스토어)</td>
                                <td class="left">카푸치노 스키니 </td>
                                <td>1</td>
                                <td>40,200</td>
                                <td rowspan="2">42,727</td>
                                <td rowspan="2">4,273</td>
                                <td rowspan="2">47,000</td>
                                <td rowspan="2">2017-08-31</td>
                                <td rowspan="2">발급신청</td>
                                <td rowspan="2">
                                    <div><button type="button" class="btn btn-sm btn-default" onclick="openOrderDetail(254)"> 주 문  정 보 </button></div>
                                    <div class="mgt3"><button type="button" class="btn btn-sm btn-info" onclick="openDealProof(205)">세금계산서</button>
                                    </div>
                                    <div class="mgt3"><button type="button" class="btn btn-sm btn-default" onclick="sendTax(205)"> 메 일  발 송 </button>
                                    </div>

                                </td>
                            </tr>

                            <tr>
                                <td class="left">【EJPXQ54】여-휘트니스</td>
                                <td>2</td>
                                <td>10,000</td>
                            </tr>

                            <tr>
                                <td rowspan="2"><input type="checkbox" name="cbList" value="203"></td>
                                <td rowspan="2">1</td>
                                <td rowspan="2">A1724353582837<br>(몰스토어)</td>
                                <td class="left">버든배낭</td>
                                <td>1</td>
                                <td>57,700</td>
                                <td rowspan="2">56,364</td>
                                <td rowspan="2">5,636</td>
                                <td rowspan="2">62,000</td>
                                <td rowspan="2">2017-08-31</td>
                                <td rowspan="2">발급신청</td>
                                <td rowspan="2">
                                    <div><button type="button" class="btn btn-sm btn-default" onclick="openOrderDetail(251)"> 주 문  정 보 </button></div>
                                    <div class="mgt3"><button type="button" class="btn btn-sm btn-info" onclick="openDealProof(203)">세금계산서</button></div>
                                    <div class="mgt3"><button type="button" class="btn btn-sm btn-default" onclick="sendTax(203)"> 메 일  발 송 </button></div>

                                </td>
                            </tr>
                            <tr>
                                <td class="left">나비리본 목걸이 </td>
                                <td>1</td>
                                <td>21,000</td>
                            </tr>

                        </tbody>
                    </table>

                    <div class="paging" style="margin-top:20px">
                        <span><a href="/order/tax_list?page=1&sissue=&sdts=&sdte=&skey=&sword="><strong>1</strong></a></span>
                    </div>

                    <ul class="order_list_btn mgt10">
                        <li>
                            <strong class="title"><i class="xi-check-circle"></i>상태수정 :</strong> 선택한 항목을
                            <select id="batchState" name="batchState" class="text_input">
                                <option value="">선택</option>
                                <option value="100">발급신청</option>
                                <option value="900">발급완료</option>
                            </select> 로(으로)
                            <button type="button" class="btn btn-sm btn-default" onclick="setStateList()">수정하기</button>
                        </li>
                        <li>
                            <strong class="title"><i class="xi-check-circle"></i> 엑셀다운 :</strong>
                            <button type="button" class="btn btn-sm btn-default" onclick="downExcel()">엑셀로 받기</button>
                        </li>
                    </ul>

                </form>




                <%- include('../inc/footer') %>
                    <!-- 달력관련 -->
                    <script>
                        var today = new Date();
                        var picker = tui.DatePicker.createRangePicker({
                            language: 'ko',
                            startpicker: {
                                date: today,
                                input: '#startpicker-input',
                                container: '#startpicker-container'
                            },
                            endpicker: {
                                date: today,
                                input: '#endpicker-input',
                                container: '#endpicker-container'
                            },
                            selectableRanges: [
                                [today, new Date(today.getFullYear() + 1, today.getMonth(), today.getDate())]
                            ]
                        });
                    </script>

                    <script type="text/javascript">
                        //<![CDATA[
                        function change() {
                            var f = document.sFrm;

                            validSearch(f);

                            f.submit();
                        }

                        function validSearch(f) {
                            if (!isDate(f.sdts.value)) f.sdts.value = "";
                            if (!isDate(f.sdte.value)) f.sdte.value = "";
                        }

                        function openOrderDetail(idx) { // 주문정보 상세보기
                            var url = "order_detail_pop";
                            var name = "Detail";
                            var option = "width=820, height=500, top=100, left=200, location=0,scrollbars=1";
                            window.open(url, name, option);
                        }

                        function openDealProof(idx) {
                            openPopup("../../common/dealproof/tax_print.pop?idx=" + idx, "DealProof", 660, 530, "scrollbars=yes");
                        }

                        function downExcel() {
                            frmProc.location.replace("tax_list.excel?sissue=&sdts=&sdte=&skey=&sword=");
                        }

                        function sendTax(idx) {
                            var f = document.Frm;

                            if (confirm("입력된 고객메일로 세금계산서를 발송 하시겠습니까?")) {
                                f.idx.value = idx;
                                f.target = "frmProc";
                                f.action = "../../common/dealproof/tax_sendmail";
                                f.submit();
                            }
                        }

                        function setStateList() {
                            var f = document.Frm;
                            var items = "";

                            var stateText = f.batchState.options[f.batchState.selectedIndex].text;
                            var stateValue = f.batchState.options[f.batchState.selectedIndex].value;

                            if (!f.cbList) return false;

                            if (stateValue == "") {
                                alert("수정할 상태를 선택해 주세요.");
                                f.batchState.focus();
                                return false;
                            }

                            $(f.cbList).each(function() {
                                if (this.checked) {
                                    items += (items ? ',' : '') + this.value;
                                }
                            });

                            if (items == '') {
                                alert(stateText + "로(으로) 수정하실 항목을 선택해 주세요.");
                                return false;
                            }

                            if (confirm("선택한 항목을 " + stateText + "로(으로) 수정하시겠습니까?")) {
                                f.idx.value = items;
                                f.action = "tax.act.asp";
                                f.submit();
                            }
                        }
                        //]]>
                    </script>

                    </body>

                    </html>